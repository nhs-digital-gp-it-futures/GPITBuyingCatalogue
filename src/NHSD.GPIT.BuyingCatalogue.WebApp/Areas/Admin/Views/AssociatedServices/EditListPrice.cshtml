@using NHSD.GPIT.BuyingCatalogue.Framework.Extensions;
    @using NHSD.GPIT.BuyingCatalogue.WebApp.Areas.Admin.Controllers;
    @using NHSD.GPIT.BuyingCatalogue.WebApp.Areas.Admin.Models.ListPriceModels
    @model EditListPriceModel

    @{
        ViewBag.Title = Model.Title;
    }

    <partial name="Partials/_BackLink" model="Model" />
    <div class="nhsuk-grid-row">
        <div class="nhsuk-grid-column-two-thirds">
            <nhs-validation-summary />
            <nhs-page-title title="@ViewBag.Title"
                            caption="@Model.ItemName"
                            advice="Provide information about the cost of the Associated Service." />
            @if (Model.Price.HasValue)
            {
                <nhs-inset-text>Any changes to this price will be visible to anyone ordering this Associated Service in future.</nhs-inset-text>
            }
            <form method="post">
                <input type="hidden" asp-for="CataloguePriceId" />
                <input type="hidden" asp-for="ItemName" />
                <input type="hidden" asp-for="BackLinkText" />
                <input type="hidden" asp-for="BackLink" />
                <input type="hidden" asp-for="Title" />
                <input type="hidden" asp-for="ItemId" />
                <nhs-fieldset-form-label id="@nameof(Model.SelectedProvisioningType)" asp-for="@Model" label-text="Provisioning type">
                    <nhs-radio-button-container>
                        @{
                            var provisioningTypes = new SelectList(EditListPriceModel.ProvisioningTypeListItems, "Value", "Text").ToList();
                            var timeUnitsSelectList = new SelectList(EditListPriceModel.TimeUnitSelectListItems, "Value", "Text");
                        }
                        <nhs-radio-button asp-for="SelectedProvisioningType"
                                          value="provisioningTypes[0]"
                                          value-name="Value"
                                          display-name="Text"
                                          index="0" />

                        <nhs-radio-button asp-for="SelectedProvisioningType"
                                          value="provisioningTypes[1]"
                                          value-name="Value"
                                          display-name="Text"
                                          index="1">
                            <nhs-select asp-for="DeclarativeTimeUnit"
                                        asp-items="timeUnitsSelectList"
                                        label-text="Unit of time"
                                        label-hint="Provide the unit of time for how this Associated Service will be billed." />
                        </nhs-radio-button>

                        <nhs-radio-button asp-for="SelectedProvisioningType"
                                          value="provisioningTypes[2]"
                                          value-name="Value"
                                          display-name="Text"
                                          index="2">
                            <nhs-select asp-for="OnDemandTimeUnit"
                                        asp-items="timeUnitsSelectList"
                                        label-text="Unit of time (optional)"
                                        label-hint="Provide the unit of time for how this Associated Service will be billed." />
                        </nhs-radio-button>
                    </nhs-radio-button-container>
                </nhs-fieldset-form-label>
                <nhs-bookended-input asp-for="Price"
                                     label-text="Price"
                                     label-hint="Provide the list price in £s to a maximum of 4 decimal places."
                                     Prefix="£" />

                <nhs-input asp-for="Unit"
                           label-text="Unit"
                           label-hint="For example, per consultation, per practice, per licence." />

                <nhs-textarea asp-for="UnitDefinition"
                              label-text="Unit definition (optional)"
                              label-hint="For example, if the unit is per day, between what hours?"
                              number-of-rows="5" />
                <nhs-submit-button text="Save and continue" />
            </form>
            @if (Model.CataloguePriceId is not null)
            {
                <vc:nhs-delete-button url="@Url.Action(
                                              nameof(AssociatedServicesController.DeleteListPrice),
                                              typeof(AssociatedServicesController).ControllerName(),
                                              new {
                                                  solutionId = Model.RelatedCatalogueItemId,
                                                  associatedServiceId = Model.ItemId,
                                                  listPriceId = Model.CataloguePriceId})"
                                      text="Delete price" />
            }
        </div>
    </div>
