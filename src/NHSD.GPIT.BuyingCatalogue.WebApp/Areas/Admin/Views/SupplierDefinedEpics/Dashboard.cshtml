@using NHSD.GPIT.BuyingCatalogue.UI.Components.Views.Shared.TagHelpers.Tags
@using NHSD.GPIT.BuyingCatalogue.WebApp.Areas.Admin.Controllers
@using NHSD.GPIT.BuyingCatalogue.Framework.Extensions
@model NHSD.GPIT.BuyingCatalogue.WebApp.Areas.Admin.Models.SupplierDefinedEpics.SupplierDefinedEpicsDashboardModel
@{
    ViewBag.Title = "Supplier defined Epics";
}
<div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-two-thirds">
        <nhs-page-title title="@ViewBag.Title"
                        advice="Add a supplier defined Epic or edit an existing one." />

        <div data-test-id="sde-add-link">
            <vc:nhs-action-link url="@Url.Action(
                nameof(SupplierDefinedEpicsController.AddEpic),
                typeof(SupplierDefinedEpicsController).ControllerName())"
                text="Add a supplier defined Epic"/>
        </div>

        <nhs-table data-test-id="sde-table">
            <nhs-table-column>Epic</nhs-table-column>
            <nhs-table-column>Capability</nhs-table-column>
            <nhs-table-column>Status</nhs-table-column>
            <nhs-table-column></nhs-table-column>
            @foreach (var supplierDefinedEpic in Model.SupplierDefinedEpics)
            {
                <nhs-table-row-container>
                    <nhs-table-cell>
                            @supplierDefinedEpic.Name
                    </nhs-table-cell>
                    <nhs-table-cell>
                            @supplierDefinedEpic.Capability
                    </nhs-table-cell>
                    <nhs-table-cell>
                        <nhs-tag
                            colour="@GetTagColour(supplierDefinedEpic.IsActive)"
                            text="@GetTagText(supplierDefinedEpic.IsActive)"/>
                    </nhs-table-cell>
                    <nhs-table-cell>
                        <a
                            asp-area="Admin"
                            asp-controller="@(typeof(SupplierDefinedEpicsController).ControllerName())"
                            asp-action="@nameof(SupplierDefinedEpicsController.EditEpic)"
                            asp-route-epicId="@supplierDefinedEpic.Id">Edit</a>
                    </nhs-table-cell>
                </nhs-table-row-container>
            }
        </nhs-table>
    </div>
</div>

@{
    NhsTagsTagHelper.TagColour GetTagColour(bool status) =>
        status ? NhsTagsTagHelper.TagColour.Green : NhsTagsTagHelper.TagColour.Grey;

    string GetTagText(bool status) => status ? "Active" : "Inactive";
}
