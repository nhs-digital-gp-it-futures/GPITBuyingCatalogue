const filterUrl="/filter",queryCapabilities="capabilities",querySelectedFramework="selectedframework",filterContainer="filter-container",filterCapabilitiesDetails="filter-capabilities-details",filterDetailsText=".nhsuk-details__text",EpicSplitCharacter="E",InputTypeHidden="input[type='hidden']",NhsukCheckboxesInput=".nhsuk-checkboxes__input",NhsukCheckboxesItem=".nhsuk-checkboxes__item",NhsRadiosInput=".nhsuk-radios__input",CapabilitiesDelimiter="|";function ReplaceFilterAndAddBinders(e){const t=document.getElementById(filterContainer),n=document.getElementById("filter-form");n.parentNode.removeChild(n),t.innerHTML=e;const r=document.getElementById("Submit");r.removeAttribute("type"),r.addEventListener("click",generateQueryParam),document.querySelectorAll(NhsRadiosInput).forEach((e=>{e.addEventListener("click",reload)})),RefireDomContentLoadedEvent(),reselectCapabilityAndEpicsFiltersAndFrameworkFilter()}function generateQueryParam(){let e="";document.querySelectorAll("#filter-container .nhsuk-checkboxes__input").forEach((t=>{if(t.checked){const n=t.parentNode.querySelector(InputTypeHidden).getAttribute("value");n.includes("E")?e+=n.substring(n.indexOf("E")):e.length>1?e+="|"+n:e+=n}}));const t=new URL(window.location.href);t.searchParams.delete("page"),t.searchParams.delete("capabilities"),t.searchParams.delete("selectedframework"),e.length>0&&t.searchParams.append("capabilities",e),t.searchParams.append("selectedframework",GetSelectedFramework()),window.location.href=t.toString()}function reload(){const e=GetSelectedFramework(),t=new URL(window.location.href);t.pathname+="/filter",t.searchParams.delete("selectedframework"),t.searchParams.append("selectedframework",e);const n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(200===n.status?refreshCapabilitiesAndEpics(n.responseText):console.log("Error: "+n.status))},n.open("GET",t.toString(),!0),n.send()}function refreshCapabilitiesAndEpics(e){const t=(new DOMParser).parseFromString(e,"text/html").getElementById(filterCapabilitiesDetails).querySelector(filterDetailsText),n=document.getElementById(filterCapabilitiesDetails).querySelector(filterDetailsText);n.parentNode.removeChild(n),document.getElementById(filterCapabilitiesDetails).appendChild(t),RefireDomContentLoadedEvent()}function reselectCapabilityAndEpicsFiltersAndFrameworkFilter(){const e=new URLSearchParams(window.location.search),t=e.get("capabilities"),n=e.get("selectedframework");if(t&&t.length>0){t.split("|").forEach((e=>{if("FC"!==e&&e.includes("E")){const t=e.split("E");t.forEach((e=>{e.startsWith("C")?CheckCheckboxWithHiddenInputValue(e):CheckCheckboxWithHiddenInputValue(t[0]+"E"+e)}))}else CheckCheckboxWithHiddenInputValue(e)}))}if(n&&n.length>0){const e=NhsRadiosInput+"[value='"+n+"']";document.querySelector(e).checked=!0}}function CheckCheckboxWithHiddenInputValue(e){const t="#filter-container .nhsuk-checkboxes__item "+InputTypeHidden+"[value='"+e+"']";document.querySelector(t).parentNode.querySelector(NhsukCheckboxesInput).click()}function GetSelectedFramework(){const e=document.querySelectorAll(NhsRadiosInput);let t="All";for(let n=0;n<e.length;n++)if(e[n].checked){t=e[n].value;break}return t}function RefireDomContentLoadedEvent(){const e="DOMContentLoaded";let t;document.createEvent?(t=document.createEvent("HTMLEvents"),t.initEvent(e,!0,!0),t.eventName=e,document.dispatchEvent(t)):(t=document.createEventObject(),t.eventName=e,t.eventType=e,document.fireEvent("on"+t.eventType,t))}window.onload=function(){const e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&(200===e.status?ReplaceFilterAndAddBinders(e.responseText):console.log("Error: "+e.status))};const t=new URL(window.location.href);t.pathname+="/filter";const n=new URLSearchParams(window.location.search).get("selectedframework");n&&n.length>0&&t.searchParams.append("selectedframework",n),e.open("GET",t.toString(),!0),e.send()};