function refreshCapabilitiesAndEpics(n){const i=(new DOMParser).parseFromString(n,"text/html"),r=i.getElementById(filterCapabilitiesDetails).querySelector(filterDetailsText),t=document.getElementById(filterCapabilitiesDetails).querySelector(filterDetailsText);t.parentNode.removeChild(t);document.getElementById(filterCapabilitiesDetails).appendChild(r);this.RefireDomContentLoadedEvent()}const filterUrl="/filter",queryCapabilities="capabilities",querySelectedFramework="selectedframework",filterContainer="filter-container",filterCapabilitiesDetails="filter-capabilities-details",filterDetailsText=".nhsuk-details__text",EpicSplitCharacter="E",DFOCVCMarker="D",SupplierSplitCharacter="S",SupplierSolutionCharacter="X",CapabilityMarker="C",InputTypeHidden="input[type='hidden']",NhsukCheckboxesInput=".nhsuk-checkboxes__input",NhsukCheckboxesItem=".nhsuk-checkboxes__item",NhsRadiosInput=".nhsuk-radios__input",CapabilitiesDelimiter="|";class CatalogueSolutionsFilter{constructor(){this.ReplaceFilterAndAddBinders=n=>{const r=document.getElementById(filterContainer),t=document.getElementById("filter-form");t.parentNode.removeChild(t);r.innerHTML=n;const i=document.getElementById("Submit");i.removeAttribute("type");i.addEventListener("click",this.generateQueryParam);document.querySelectorAll(NhsRadiosInput).forEach(n=>{n.addEventListener("click",this.reload)});this.RefireDomContentLoadedEvent();this.reselectCapabilityAndEpicsFiltersAndFrameworkFilter()};this.generateQueryParam=()=>{let n="",i="#"+filterContainer+" "+NhsukCheckboxesInput;document.querySelectorAll(i).forEach(t=>{const i=t;if(i.checked){let i=null;i=t.parentNode.querySelector(InputTypeHidden).getAttribute("value");n+=i.includes(SupplierSplitCharacter)?this.EncodeSupplierDefinedEpic(i):i.includes(EpicSplitCharacter)&&!i.includes(CapabilityMarker)?this.EncodeDFOCVCEpic(i):i.includes(EpicSplitCharacter)&&i.includes(CapabilityMarker)?this.EncodeNormalEpic(i):n.length>1?CapabilitiesDelimiter+i:i}});const t=new URL(window.location.href);t.searchParams.delete("page");t.searchParams.delete(queryCapabilities);t.searchParams.delete(querySelectedFramework);n.length>0&&t.searchParams.append(queryCapabilities,n);t.searchParams.append(querySelectedFramework,this.GetSelectedFramework());window.location.href=t.toString()};this.reload=()=>{const i=this.GetSelectedFramework(),t=new URL(window.location.href);t.pathname+=filterUrl;t.searchParams.delete(querySelectedFramework);t.searchParams.append(querySelectedFramework,i);const n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState===4&&(n.status===200?refreshCapabilitiesAndEpics(n.responseText):console.log("Error: "+n.status))}};this.reselectCapabilityAndEpicsFiltersAndFrameworkFilter=()=>{const r="FC",u="C",i=new URLSearchParams(window.location.search),n=i.get(queryCapabilities),t=i.get(querySelectedFramework);if(n&&n.length>0){const t=n.split(CapabilitiesDelimiter);t.forEach(n=>{if(n!==r&&n.includes(EpicSplitCharacter)){const t=n.split(SupplierSplitCharacter).map(n=>n.split(EpicSplitCharacter)).concat.apply([]);t.forEach(n=>{n.startsWith(u)?this.CheckCheckboxWithHiddenInputValue(n):n.includes(DFOCVCMarker)?this.CheckCheckboxWithHiddenInputValue(this.DecodeDFOCVCEpic(n)):n.includes(SupplierSolutionCharacter)?this.CheckCheckboxWithHiddenInputValue(this.DecodeSupplierDefinedEpic(n)):this.CheckCheckboxWithHiddenInputValue(this.DecodeNormalEpic(t[0],n))})}else this.CheckCheckboxWithHiddenInputValue(n)})}if(t&&t.length>0){const n=NhsRadiosInput+"[value='"+t+"']",i=document.querySelector(n);i.checked=!0}}}CheckCheckboxWithHiddenInputValue(n){const t="#"+filterContainer+" "+NhsukCheckboxesItem+" "+InputTypeHidden+"[value='"+n+"']",i=document.querySelector(t).parentNode.querySelector(NhsukCheckboxesInput);i.click()}GetSelectedFramework(){const n=document.querySelectorAll(NhsRadiosInput);let t="All";for(let i=0;i<n.length;i++){const r=n[i];if(r.checked){t=r.value;break}}return t}RefireDomContentLoadedEvent(){window.document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!0,cancelable:!0}))}EncodeNormalEpic(n){return n.substring(n.indexOf(EpicSplitCharacter))}EncodeDFOCVCEpic(n){return EpicSplitCharacter+n.substring(4)+DFOCVCMarker}EncodeSupplierDefinedEpic(n){return n.replace("E0","_").replace("S0","S").replace("X0","X")}DecodeNormalEpic(n,t){return n+EpicSplitCharacter+t}DecodeDFOCVCEpic(n){return"E000"+n.substring(0,2)}DecodeSupplierDefinedEpic(n){return("S0"+n).replace("_","E0").replace("X","X0")}}window.onload=function(){var r=new CatalogueSolutionsFilter;const n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState===4&&(n.status===200?r.ReplaceFilterAndAddBinders(n.responseText):console.log("Error: "+n.status))};const t=new URL(window.location.href);t.pathname+=filterUrl;const u=new URLSearchParams(window.location.search),i=u.get(querySelectedFramework);i&&i.length>0&&t.searchParams.append(querySelectedFramework,i);n.open("GET",t.toString(),!0);n.send()};